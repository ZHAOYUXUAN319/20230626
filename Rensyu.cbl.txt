IDENTIFICATION DIVISION.
PROGRAM-ID. ACCOUNTING-PROCESSING.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 ACCOUNT-RECORD.
   05 ACCOUNT-NUMBER   PIC X(10).
   05 ACCOUNT-NAME     PIC X(30).
   05 ACCOUNT-BALANCE  PIC S9(9)V99.

01 INVOICE-RECORD.
   05 INVOICE-NUMBER   PIC X(10).
   05 INVOICE-AMOUNT   PIC S9(9)V99.

01 RECEIPT-RECORD.
   05 RECEIPT-NUMBER   PIC X(10).
   05 RECEIPT-AMOUNT   PIC S9(9)V99.

01 REPORT-RECORD.
   05 REPORT-LINE      PIC X(80).

PROCEDURE DIVISION.
MAIN-LOGIC SECTION.
    PERFORM READ-ACCOUNT UNTIL ACCOUNT-NUMBER = '9999999999'.
    PERFORM PROCESS-INVOICE UNTIL INVOICE-NUMBER = '9999999999'.
    PERFORM PROCESS-RECEIPT UNTIL RECEIPT-NUMBER = '9999999999'.
    PERFORM GENERATE-REPORT.
    STOP RUN.

READ-ACCOUNT SECTION.
    DISPLAY '************ ACCOUNT PROCESSING ************'.
    DISPLAY 'Please enter account details (9999999999 to exit):'.
    DISPLAY 'Account Number: ' WITH NO ADVANCING.
    ACCEPT ACCOUNT-NUMBER.
    IF ACCOUNT-NUMBER <> '9999999999'
        DISPLAY 'Account Name: ' WITH NO ADVANCING.
        ACCEPT ACCOUNT-NAME.
        DISPLAY 'Account Balance: ' WITH NO ADVANCING.
        ACCEPT ACCOUNT-BALANCE.
        PERFORM WRITE-ACCOUNT.
    END-IF.

PROCESS-INVOICE SECTION.
    DISPLAY 'Please enter invoice details (9999999999 to exit):'.
    DISPLAY 'Invoice Number: ' WITH NO ADVANCING.
    ACCEPT INVOICE-NUMBER.
    IF INVOICE-NUMBER <> '9999999999'
        DISPLAY 'Invoice Amount: ' WITH NO ADVANCING.
        ACCEPT INVOICE-AMOUNT.
        PERFORM PROCESS-INVOICE-LOGIC.
    END-IF.

PROCESS-RECEIPT SECTION.
    DISPLAY 'Please enter receipt details (9999999999 to exit):'.
    DISPLAY 'Receipt Number: ' WITH NO ADVANCING.
    ACCEPT RECEIPT-NUMBER.
    IF RECEIPT-NUMBER <> '9999999999'
        DISPLAY 'Receipt Amount: ' WITH NO ADVANCING.
        ACCEPT RECEIPT-AMOUNT.
        PERFORM PROCESS-RECEIPT-LOGIC.
    END-IF.

GENERATE-REPORT SECTION.
    DISPLAY '************ REPORT ************'.
    DISPLAY 'Generating report...'.
    PERFORM PRINT-REPORT.

WRITE-ACCOUNT SECTION.
    DISPLAY 'Writing account record: ' ACCOUNT-NUMBER
    MOVE ACCOUNT-RECORD TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD.

PROCESS-INVOICE-LOGIC SECTION.

    DISPLAY 'Processing invoice: ' INVOICE-NUMBER
    COMPUTE ACCOUNT-BALANCE = ACCOUNT-BALANCE - INVOICE-AMOUNT.

PROCESS-RECEIPT-LOG
